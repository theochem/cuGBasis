<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Quick Start &mdash; cugbasis  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/override.css" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="QTAIM Critical Points" href="critical_points.html" />
    <link rel="prev" title="Conventions" href="conventions.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            cugbasis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#downloading-code">Downloading Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#id1">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#python-binding">Python Binding</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#c">C++</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#compute-canada">Compute Canada</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installation-problems">Installation problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#building-documentation">Building Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="molecule.html">Molecule Class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="molecule.html#cugbasis.Molecule"><code class="docutils literal notranslate"><span class="pre">Molecule</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_density"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_electrostatic_potential"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_electrostatic_potential()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_empirical_gradient_expansion_ked"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_empirical_gradient_expansion_ked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_general_gradient_expansion_ked"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_general_gradient_expansion_ked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_general_ked"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_general_ked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_general_kinetic_energy_density"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_general_kinetic_energy_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_gradient"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_gradient()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_gradient_expansion_ked"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_gradient_expansion_ked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_hessian"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_hessian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_laplacian"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_laplacian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_molecular_orbitals"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_molecular_orbitals()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_norm_of_vector"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_norm_of_vector()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_positive_definite_kinetic_energy_density"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_positive_definite_kinetic_energy_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_reduced_density_gradient"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_reduced_density_gradient()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_schrodinger_ked"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_schrodinger_ked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_shannon_information_density"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_shannon_information_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_thomas_fermi_ked"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_thomas_fermi_ked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_weizsacker_ked"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_weizsacker_ked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.coordinates"><code class="docutils literal notranslate"><span class="pre">Molecule.coordinates</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.get_file_path"><code class="docutils literal notranslate"><span class="pre">Molecule.get_file_path()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.numbers"><code class="docutils literal notranslate"><span class="pre">Molecule.numbers</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="conventions.html">Conventions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="conventions.html#gaussian-primitives">Gaussian Primitives</a><ul>
<li class="toctree-l3"><a class="reference internal" href="conventions.html#cartesian">Cartesian</a></li>
<li class="toctree-l3"><a class="reference internal" href="conventions.html#spherical-pure">Spherical/Pure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="conventions.html#contractions">Contractions</a></li>
<li class="toctree-l2"><a class="reference internal" href="conventions.html#basis-set-groupings-shells">Basis-set Groupings (Shells)</a></li>
<li class="toctree-l2"><a class="reference internal" href="conventions.html#basis-set-ordering">Basis Set Ordering</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Constructing-Molecule-Object">Constructing Molecule Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Electron-Density">Electron Density</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#Molecular-Integration-and-Dipole-Moment">Molecular Integration and Dipole Moment</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Isosurface-and-Cube-Files">Isosurface and Cube Files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#Electron-Localization-Function-(ELF)">Electron Localization Function (ELF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Non-Covalent-Interactions-(NCI)">Non-Covalent Interactions (NCI)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="critical_points.html">QTAIM Critical Points</a><ul>
<li class="toctree-l2"><a class="reference internal" href="critical_points.html#Using-Default-Initial-Guess">Using Default Initial Guess</a></li>
<li class="toctree-l2"><a class="reference internal" href="critical_points.html#Challenging-Cases">Challenging Cases</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reduced_density_gradient.html">Non-Covalent Interaction Index</a><ul>
<li class="toctree-l2"><a class="reference internal" href="reduced_density_gradient.html#Constructing-Molecule-Object">Constructing Molecule Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="reduced_density_gradient.html#Reduced-Density-Gradient-Isosurface">Reduced Density Gradient Isosurface</a></li>
<li class="toctree-l2"><a class="reference internal" href="reduced_density_gradient.html#NCI-Index-Using-The-Hessian">NCI Index Using The Hessian</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="generating_cube_files.html">Generating Cube Files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="generating_cube_files.html#Density">Density</a></li>
<li class="toctree-l2"><a class="reference internal" href="generating_cube_files.html#Laplacian">Laplacian</a></li>
<li class="toctree-l2"><a class="reference internal" href="generating_cube_files.html#Reduced-Density-Gradient">Reduced Density Gradient</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">cugbasis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">Quick Start</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/quick_start.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="Quick-Start">
<h1>Quick Start<a class="headerlink" href="#Quick-Start" title="Permalink to this heading"></a></h1>
<p><a class="reference external" href="https://cugbasis.qcdevs.org/index.html">CuGBasis</a> is suitable for the evaluation of the electron density and its various derivatives of interest for the quantum chemistry community. It offers an easy to use functionality, being highly applicable to larger systems, and can read various popular wave-function formats. This example will illustrate various different post-processing tools that cuGBasis can be used for.</p>
<section id="Constructing-Molecule-Object">
<h2>Constructing Molecule Object<a class="headerlink" href="#Constructing-Molecule-Object" title="Permalink to this heading"></a></h2>
<p>The first-step is to read the wave-function file and constructing the Molecule class.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">cugbasis</span> <span class="kn">import</span> <span class="n">Molecule</span>

<span class="n">file_path</span> <span class="o">=</span> <span class="sa">r</span><span class="s2">&quot;./ALA_ALA_0_q000_m01_k00_force_uwb97xd_def2svpd.fchk&quot;</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">Molecule</span><span class="p">(</span><span class="n">file_path</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="Electron-Density">
<h2>Electron Density<a class="headerlink" href="#Electron-Density" title="Permalink to this heading"></a></h2>
<p>The molecule class can efficiently calculate the electron density. These examples will use <a class="reference external" href="https://grid.qcdevs.org/index.html">Grid</a> package to construct various grids for evaluation.</p>
<section id="Molecular-Integration-and-Dipole-Moment">
<h3>Molecular Integration and Dipole Moment<a class="headerlink" href="#Molecular-Integration-and-Dipole-Moment" title="Permalink to this heading"></a></h3>
<p>The integration of the electorn density</p>
<div class="math notranslate nohighlight">
\[\int \rho(\mathbf{r}) d\mathbf{r} = N\]</div>
<p>should provide the total number of electrons. This example will construct a Becke-Lebedev grid using <a class="reference external" href="https://grid.qcdevs.org/pyapi/grid.molgrid.html">MolGrid</a> object from grid package using <a class="reference external" href="https://grid.qcdevs.org/pyapi/grid.hirshfeld.html">Hirshfeld</a> atom-in molecules weights. Additionally, it will calculate the dipole moment of this peptide.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">grid.molgrid</span> <span class="kn">import</span> <span class="n">MolGrid</span>
<span class="kn">from</span> <span class="nn">grid.hirshfeld</span> <span class="kn">import</span> <span class="n">HirshfeldWeights</span>
<span class="kn">from</span> <span class="nn">grid.utils</span> <span class="kn">import</span> <span class="n">dipole_moment_of_molecule</span>

<span class="c1"># Construct Molecular Grid</span>
<span class="n">atom_numbers</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">numbers</span>     <span class="c1"># Atomic numbers</span>
<span class="n">atom_coords</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span>  <span class="c1"># Atomic coordinates</span>
<span class="n">molgrid</span> <span class="o">=</span> <span class="n">MolGrid</span><span class="o">.</span><span class="n">from_preset</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">numbers</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">),</span> <span class="n">atom_coords</span><span class="p">,</span> <span class="n">preset</span><span class="o">=</span><span class="s2">&quot;fine&quot;</span><span class="p">,</span> <span class="n">aim_weights</span><span class="o">=</span><span class="n">HirshfeldWeights</span><span class="p">())</span>

<span class="c1"># Calculate density over grid</span>
<span class="n">density</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_density</span><span class="p">(</span><span class="n">molgrid</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Total number of electrons:       </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">atom_numbers</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Integration of electron density: </span><span class="si">{</span><span class="n">molgrid</span><span class="o">.</span><span class="n">integrate</span><span class="p">(</span><span class="n">density</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Calculate Dipole Moment</span>
<span class="n">dipole</span> <span class="o">=</span> <span class="n">dipole_moment_of_molecule</span><span class="p">(</span><span class="n">molgrid</span><span class="p">,</span> <span class="n">density</span><span class="p">,</span> <span class="n">atom_coords</span><span class="p">,</span> <span class="n">atom_numbers</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Dipole Moment: </span><span class="si">{</span><span class="n">dipole</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
/home/ali-tehrani/miniconda2/envs/py37/lib/python3.7/site-packages/grid/atomgrid.py:896: UserWarning: Lebedev weights are negative which can introduce round-off errors.
  sphere_grid = AngularGrid(degree=deg_i, method=method)
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Total number of electrons:       108
Integration of electron density: 107.99956413601713
Dipole Moment: [-1.19887145  1.57689994 -1.90832791]
</pre></div></div>
</div>
</section>
<section id="Isosurface-and-Cube-Files">
<h3>Isosurface and Cube Files<a class="headerlink" href="#Isosurface-and-Cube-Files" title="Permalink to this heading"></a></h3>
<p>This example will calculate the isosurface of the electron density. Grid package is used to construct an uniform grid around the molecule from which an isosurface is obtained from <a class="reference external" href="https://scikit-image.org/docs/stable/api/skimage.measure.html#skimage.measure.marching_cubes">skimage marching cubes</a> implementation.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">grid.cubic</span> <span class="kn">import</span> <span class="n">UniformGrid</span>

<span class="n">grid</span> <span class="o">=</span> <span class="n">UniformGrid</span><span class="o">.</span><span class="n">from_molecule</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">numbers</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="mf">8.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cubic Grid Shape: </span><span class="si">{</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of Points: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">points</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">dens</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_density</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>

<span class="c1"># Optional: Save the cube file</span>
<span class="c1">#grid.generate_cube(&quot;./density_ALA_ALA.cube&quot;, dens, mol.coordinates, mol.numbers)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Cubic Grid Shape: [161 140 109]
Number of Points: 2456860
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">skimage.measure</span> <span class="kn">import</span> <span class="n">marching_cubes</span>

<span class="c1"># Reshape density to have the cubic shape (N_x, N_y, N_z) for marching cubes</span>
<span class="n">dens_shaped</span> <span class="o">=</span> <span class="n">dens</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># Run marching cubes algorithm</span>
<span class="n">kverts</span><span class="p">,</span> <span class="n">kfaces</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">marching_cubes</span><span class="p">(</span><span class="n">dens_shaped</span><span class="p">,</span> <span class="mf">0.001</span><span class="p">,</span> <span class="n">allow_degenerate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">kverts</span> <span class="o">=</span> <span class="n">kverts</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span> <span class="o">+</span> <span class="n">grid</span><span class="o">.</span><span class="n">origin</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of vertices: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">kverts</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="c1"># Compute the density again on the isosurface to validate it</span>
<span class="n">dens_iso</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_density</span><span class="p">(</span><span class="n">kverts</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Mean Density on isosurface: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">dens_iso</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;STD  Density on isosurface: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">dens_iso</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of vertices: 33112
Mean Density on isosurface: 0.000992616754025689
STD  Density on isosurface: 6.736985660476871e-06
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_trisurf</span><span class="p">(</span><span class="n">kverts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">kverts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">kverts</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">triangles</span><span class="o">=</span><span class="n">kfaces</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Isosurface (0.001 au) of Alanine-Alanine Dipeptide&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<br/></pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_9_0.png" src="_images/quick_start_9_0.png" />
</div>
</div>
</section>
</section>
<section id="Electron-Localization-Function-(ELF)">
<h2>Electron Localization Function (ELF)<a class="headerlink" href="#Electron-Localization-Function-(ELF)" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">chemtools.toolbox.interactions</span> <span class="kn">import</span> <span class="n">ELF</span>
<span class="kn">from</span> <span class="nn">skimage.measure</span> <span class="kn">import</span> <span class="n">marching_cubes</span>

<span class="n">grid</span> <span class="o">=</span> <span class="n">UniformGrid</span><span class="o">.</span><span class="n">from_molecule</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">numbers</span><span class="p">,</span> <span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">,</span> <span class="n">spacing</span><span class="o">=</span><span class="mf">0.25</span><span class="p">,</span> <span class="n">extension</span><span class="o">=</span><span class="mf">8.0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Cubic Grid Shape: </span><span class="si">{</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of Points: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">points</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">dens</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_density</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>

<span class="c1"># Evaluate quantities for Electron Localization Function</span>
<span class="n">grad</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_gradient</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
<span class="n">ked</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_positive_definite_kinetic_energy_density</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>

<span class="n">elf</span> <span class="o">=</span> <span class="n">ELF</span><span class="p">(</span><span class="n">dens</span><span class="p">,</span> <span class="n">grad</span><span class="p">,</span> <span class="n">ked</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">trans</span><span class="o">=</span><span class="s2">&quot;rational&quot;</span><span class="p">,</span> <span class="n">trans_k</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">trans_a</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">denscut</span><span class="o">=</span><span class="mf">0.0005</span><span class="p">)</span>

<span class="c1"># Optional: create cube files</span>
<span class="c1">#grid.generate_cube(&quot;elf_ALA_ALA.cube&quot;, elf.value, mol.coordinates, mol.numbers)</span>

<span class="c1"># Optional: create vmd file for visualization</span>
<span class="c1">#elf.generate_scripts(&quot;elf_ALA_ALA.vmd&quot;, isosurf=0.8)</span>

<span class="c1"># Run marching cubes algorithm for generating isosurface</span>
<span class="n">elf_vals</span> <span class="o">=</span> <span class="n">elf</span><span class="o">.</span><span class="n">value</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="n">kverts</span><span class="p">,</span> <span class="n">kfaces</span><span class="p">,</span> <span class="n">_</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">marching_cubes</span><span class="p">(</span><span class="n">elf_vals</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">,</span> <span class="n">allow_degenerate</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">kverts</span> <span class="o">=</span> <span class="n">kverts</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">axes</span><span class="p">)</span> <span class="o">+</span> <span class="n">grid</span><span class="o">.</span><span class="n">origin</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Number of vertices: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">kverts</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Cubic Grid Shape: [129 112  87]
Number of Points: 1256976
Number of vertices: 17591
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">gca</span><span class="p">(</span><span class="n">projection</span><span class="o">=</span><span class="s2">&quot;3d&quot;</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">plot_trisurf</span><span class="p">(</span><span class="n">kverts</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">kverts</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">kverts</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">triangles</span><span class="o">=</span><span class="n">kfaces</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s2">&quot;off&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;ELF Isosurface (0.8 val) of </span><span class="se">\n</span><span class="s2"> Alanine-Alanine Dipeptide&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_12_0.png" src="_images/quick_start_12_0.png" />
</div>
</div>
</section>
<section id="Non-Covalent-Interactions-(NCI)">
<h2>Non-Covalent Interactions (NCI)<a class="headerlink" href="#Non-Covalent-Interactions-(NCI)" title="Permalink to this heading"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">from</span> <span class="nn">chemtools.toolbox.interactions</span> <span class="kn">import</span> <span class="n">NCI</span>

<span class="c1"># Evaluate quantities for Electron Localization Function</span>
<span class="n">density</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_density</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
<span class="n">rdg</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_reduced_density_gradient</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>
<span class="n">hessian</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_hessian</span><span class="p">(</span><span class="n">grid</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>

<span class="n">nci</span> <span class="o">=</span> <span class="n">NCI</span><span class="p">(</span><span class="n">density</span><span class="p">,</span> <span class="n">rdg</span><span class="p">,</span> <span class="n">grid</span><span class="o">=</span><span class="n">grid</span><span class="p">,</span> <span class="n">hessian</span><span class="o">=</span><span class="n">hessian</span><span class="p">)</span>

<span class="c1"># Optional: create vmd file for visualization</span>
<span class="c1">#nci.generate_scripts(&quot;nci_ALA_ALA.vmd&quot;, isosurf=0.5, denscut=0.05)</span>

<span class="c1"># Create plot</span>
<span class="n">nci</span><span class="o">.</span><span class="n">generate_plot</span><span class="p">(</span><span class="s2">&quot;nci_ALA_ALA.png&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area stderr docutils container">
<div class="highlight"><pre>
findfont: Font family [&#39;serif&#39;] not found. Falling back to DejaVu Sans.
findfont: Font family [&#39;serif&#39;] not found. Falling back to DejaVu Sans.
</pre></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/quick_start_14_1.png" src="_images/quick_start_14_1.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="conventions.html" class="btn btn-neutral float-left" title="Conventions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="critical_points.html" class="btn btn-neutral float-right" title="QTAIM Critical Points" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, QC-Devs.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>