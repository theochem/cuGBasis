<!DOCTYPE html>
<html class="writer-html5" lang="en">
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.19: https://docutils.sourceforge.io/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>QTAIM Critical Points &mdash; cugbasis  documentation</title>
      <link rel="stylesheet" type="text/css" href="_static/pygments.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/override.css" />
      <link rel="stylesheet" type="text/css" href="_static/nbsphinx-code-cells.css" />
      <link rel="stylesheet" type="text/css" href="_static/css/custom.css" />

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/_sphinx_javascript_frameworks_compat.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/sphinx_highlight.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Non-Covalent Interaction Index" href="reduced_density_gradient.html" />
    <link rel="prev" title="Quick Start" href="quick_start.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="index.html" class="icon icon-home">
            cugbasis
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">User documentation:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="installation.html#downloading-code">Downloading Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#dependencies">Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#id1">Installation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="installation.html#python-binding">Python Binding</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#c">C++</a></li>
<li class="toctree-l3"><a class="reference internal" href="installation.html#compute-canada">Compute Canada</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#installation-problems">Installation problems</a></li>
<li class="toctree-l2"><a class="reference internal" href="installation.html#building-documentation">Building Documentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="molecule.html">Molecule Class</a><ul>
<li class="toctree-l2"><a class="reference internal" href="molecule.html#cugbasis.Molecule"><code class="docutils literal notranslate"><span class="pre">Molecule</span></code></a><ul>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_density"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_electrostatic_potential"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_electrostatic_potential()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_empirical_gradient_expansion_ked"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_empirical_gradient_expansion_ked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_general_gradient_expansion_ked"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_general_gradient_expansion_ked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_general_ked"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_general_ked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_general_kinetic_energy_density"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_general_kinetic_energy_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_gradient"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_gradient()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_gradient_expansion_ked"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_gradient_expansion_ked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_hessian"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_hessian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_laplacian"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_laplacian()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_molecular_orbitals"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_molecular_orbitals()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_norm_of_vector"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_norm_of_vector()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_positive_definite_kinetic_energy_density"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_positive_definite_kinetic_energy_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_reduced_density_gradient"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_reduced_density_gradient()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_schrodinger_ked"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_schrodinger_ked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_shannon_information_density"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_shannon_information_density()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_thomas_fermi_ked"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_thomas_fermi_ked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.compute_weizsacker_ked"><code class="docutils literal notranslate"><span class="pre">Molecule.compute_weizsacker_ked()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.coordinates"><code class="docutils literal notranslate"><span class="pre">Molecule.coordinates</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.get_file_path"><code class="docutils literal notranslate"><span class="pre">Molecule.get_file_path()</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="molecule.html#cugbasis.Molecule.numbers"><code class="docutils literal notranslate"><span class="pre">Molecule.numbers</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="conventions.html">Conventions</a><ul>
<li class="toctree-l2"><a class="reference internal" href="conventions.html#gaussian-primitives">Gaussian Primitives</a><ul>
<li class="toctree-l3"><a class="reference internal" href="conventions.html#cartesian">Cartesian</a></li>
<li class="toctree-l3"><a class="reference internal" href="conventions.html#spherical-pure">Spherical/Pure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="conventions.html#contractions">Contractions</a></li>
<li class="toctree-l2"><a class="reference internal" href="conventions.html#basis-set-groupings-shells">Basis-set Groupings (Shells)</a></li>
<li class="toctree-l2"><a class="reference internal" href="conventions.html#basis-set-ordering">Basis Set Ordering</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Example Tutorials:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a><ul>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#Constructing-Molecule-Object">Constructing Molecule Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#Electron-Density">Electron Density</a><ul>
<li class="toctree-l3"><a class="reference internal" href="quick_start.html#Molecular-Integration-and-Dipole-Moment">Molecular Integration and Dipole Moment</a></li>
<li class="toctree-l3"><a class="reference internal" href="quick_start.html#Isosurface-and-Cube-Files">Isosurface and Cube Files</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#Electron-Localization-Function-(ELF)">Electron Localization Function (ELF)</a></li>
<li class="toctree-l2"><a class="reference internal" href="quick_start.html#Non-Covalent-Interactions-(NCI)">Non-Covalent Interactions (NCI)</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">QTAIM Critical Points</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#Using-Default-Initial-Guess">Using Default Initial Guess</a></li>
<li class="toctree-l2"><a class="reference internal" href="#Challenging-Cases">Challenging Cases</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="reduced_density_gradient.html">Non-Covalent Interaction Index</a><ul>
<li class="toctree-l2"><a class="reference internal" href="reduced_density_gradient.html#Constructing-Molecule-Object">Constructing Molecule Object</a></li>
<li class="toctree-l2"><a class="reference internal" href="reduced_density_gradient.html#Reduced-Density-Gradient-Isosurface">Reduced Density Gradient Isosurface</a></li>
<li class="toctree-l2"><a class="reference internal" href="reduced_density_gradient.html#NCI-Index-Using-The-Hessian">NCI Index Using The Hessian</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="generating_cube_files.html">Generating Cube Files</a><ul>
<li class="toctree-l2"><a class="reference internal" href="generating_cube_files.html#Density">Density</a></li>
<li class="toctree-l2"><a class="reference internal" href="generating_cube_files.html#Laplacian">Laplacian</a></li>
<li class="toctree-l2"><a class="reference internal" href="generating_cube_files.html#Reduced-Density-Gradient">Reduced Density Gradient</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">cugbasis</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home" aria-label="Home"></a></li>
      <li class="breadcrumb-item active">QTAIM Critical Points</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/critical_points.nblink.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="QTAIM-Critical-Points">
<h1>QTAIM Critical Points<a class="headerlink" href="#QTAIM-Critical-Points" title="Permalink to this heading"></a></h1>
<p>This example illustrates how to find the QTAIM critical points and bond-paths using ChemTools and CuGbasis. This is precisely when the gradient of the electron density <span class="math notranslate nohighlight">\(\nabla \rho = 0\)</span> is zero. The first step is to load the wavefunction information using CuGBasis.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cugbasis</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Load the wavefunction information</span>
<span class="n">fchk_path</span> <span class="o">=</span> <span class="s2">&quot;./ALA_ALA_0_q000_m01_k00_force_uwb97xd_def2svpd.fchk&quot;</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">cugbasis</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span><span class="n">fchk_path</span><span class="p">)</span>

<span class="c1"># Get the atomic coordinates and numbers</span>
<span class="n">atom_coords</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span>
<span class="n">atom_numbers</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">numbers</span>
<span class="n">natoms</span> <span class="o">=</span> <span class="n">atom_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<section id="Using-Default-Initial-Guess">
<h2>Using Default Initial Guess<a class="headerlink" href="#Using-Default-Initial-Guess" title="Permalink to this heading"></a></h2>
<p>In this example, we will provide only the atomic coordinates and it will generate initial guesses where the gradient of the electron density is close to zero. This should roughly be near the center of each atom, inbetween any two atoms and between three/four atoms. The electron density, gradient and hessian are obtained from CuGBasis and use is given to the ChemTools algorithm for efficiently finding the critical points and then find the bond-paths for all bond-critical points.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">chemtools.topology.critical</span> <span class="kn">import</span> <span class="n">Topology</span>

<span class="n">dens_func</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_density</span>
<span class="n">grad_func</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_gradient</span>
<span class="n">hess_func</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_hessian</span>

<span class="n">topo</span> <span class="o">=</span> <span class="n">Topology</span><span class="p">(</span><span class="n">dens_func</span><span class="p">,</span> <span class="n">grad_func</span><span class="p">,</span> <span class="n">hess_func</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">atom_coords</span><span class="p">)</span>
<span class="n">topo</span><span class="o">.</span><span class="n">find_critical_points_vectorized</span><span class="p">(</span><span class="n">atom_coords</span><span class="p">,</span> <span class="n">use_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Is Poincare-Hopf Equation Satisfied?:  </span><span class="si">{</span><span class="n">topo</span><span class="o">.</span><span class="n">poincare_hopf_equation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">topo</span><span class="o">.</span><span class="n">find_bond_paths</span><span class="p">(</span><span class="n">tol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span> <span class="n">max_ss</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Start Critical Points Finding.
Number of initial points: 7078
Iteration: 1,   Sum Gradient Norm of pts left: 13795.26664591485   Number of pts left: 7078
Iteration: 2,   Sum Gradient Norm of pts left: 16780.400882584137   Number of pts left: 6406
Iteration: 3,   Sum Gradient Norm of pts left: 8817.066657700365   Number of pts left: 5621
Iteration: 4,   Sum Gradient Norm of pts left: 6677.456524919042   Number of pts left: 5044
Iteration: 5,   Sum Gradient Norm of pts left: 7703.419316732867   Number of pts left: 4542
Iteration: 6,   Sum Gradient Norm of pts left: 5181.546111085325   Number of pts left: 3644
Iteration: 7,   Sum Gradient Norm of pts left: 3920.4795305932676   Number of pts left: 2636
Iteration: 8,   Sum Gradient Norm of pts left: 2872.2573213748974   Number of pts left: 1780
Iteration: 9,   Sum Gradient Norm of pts left: 1989.0294892860857   Number of pts left: 1171
Iteration: 10,   Sum Gradient Norm of pts left: 1207.2857892143145   Number of pts left: 750
Iteration: 11,   Sum Gradient Norm of pts left: 1365.7288943831077   Number of pts left: 500
Iteration: 12,   Sum Gradient Norm of pts left: 334.7816083341251   Number of pts left: 330
Iteration: 13,   Sum Gradient Norm of pts left: 1283.755969682446   Number of pts left: 219
Iteration: 14,   Sum Gradient Norm of pts left: 223.65822783103656   Number of pts left: 134
Iteration: 15,   Sum Gradient Norm of pts left: 156.539276677374   Number of pts left: 95
Iteration: 16,   Sum Gradient Norm of pts left: 35.491083921338465   Number of pts left: 68
Iteration: 17,   Sum Gradient Norm of pts left: 278.25726013961315   Number of pts left: 46
Iteration: 18,   Sum Gradient Norm of pts left: 2.790225722591271   Number of pts left: 32
Iteration: 19,   Sum Gradient Norm of pts left: 0.8964181432629607   Number of pts left: 20
Iteration: 20,   Sum Gradient Norm of pts left: 0.34165905752363   Number of pts left: 13
Iteration: 21,   Sum Gradient Norm of pts left: 0.17196361371146468   Number of pts left: 10
Iteration: 22,   Sum Gradient Norm of pts left: 0.1410298852305501   Number of pts left: 5
Iteration: 23,   Sum Gradient Norm of pts left: 0.06653078857485395   Number of pts left: 4
Iteration: 24,   Sum Gradient Norm of pts left: 0.0165977830289024   Number of pts left: 2
Iteration: 25,   Sum Gradient Norm of pts left: 5.4636591286238576e-05   Number of pts left: 1
Iteration: 26,   Sum Gradient Norm of pts left: 4.465092962324014e-10   Number of pts left: 1
Final number of points found 61
Is Poincare-Hopf Equation Satisfied?:  True
</pre></div></div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Grab the critical points</span>
<span class="n">bcp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">coordinate</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">bcp</span><span class="p">])</span>
<span class="n">nna</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">coordinate</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">nna</span><span class="p">])</span>
<span class="n">rcp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">coordinate</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">rcp</span><span class="p">])</span>
<span class="n">ccp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">coordinate</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">ccp</span><span class="p">])</span>

<span class="c1"># Evaluate different properties on the critical points</span>
<span class="n">lap_nna</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_laplacian</span><span class="p">(</span><span class="n">nna</span><span class="p">)</span>
<span class="n">rdg_nna</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_reduced_density_gradient</span><span class="p">(</span><span class="n">nna</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Plot the critical points and bond paths</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="s1">&#39;3d&#39;</span><span class="p">})</span>
<span class="c1"># Plot the bond paths</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">bcp</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">bp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Plot the critical points</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rcp</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rcp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">rcp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">rcp</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;RCP&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ccp</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ccp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">ccp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ccp</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CCP&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bcp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">bcp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bcp</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;BCP&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">nna</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nna</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">nna</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;(N)NA&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower center&quot;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;expand&quot;</span><span class="p">)</span> <span class="c1">#</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;QTAIM Critical Points and Bond Paths&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/critical_points_6_0.png" src="_images/critical_points_6_0.png" />
</div>
</div>
</section>
<section id="Challenging-Cases">
<h2>Challenging Cases<a class="headerlink" href="#Challenging-Cases" title="Permalink to this heading"></a></h2>
<p>This example will illustrate a case, with a much large peptide, where the default initial guesses were not sufficient for finding all of the critical points. This can be determined from the Poincare-Hopf equation not being satisfied. In such scenario, the user will need to add more and better initial guesses.</p>
<p>This example will use <a class="reference external" href="https://grid.qcdevs.org/pyapi/grid.atomgrid.html">Grid</a> package to construct an Becke-Lebedev grid (Atomic Grid) around each atom. This is based on constructing grids over spherical coordinates <span class="math notranslate nohighlight">\((r, \theta, \phi)\)</span>, where a radial grid is constructed over the <span class="math notranslate nohighlight">\(r\)</span> coordinate and an angular grid over the <span class="math notranslate nohighlight">\((\theta, \phi)\)</span> coordinate. Due to the large size of the format check-point file, the user will need to use git lfs to download the file via the command
<code class="docutils literal notranslate"><span class="pre">git</span> <span class="pre">lfs</span> <span class="pre">fetch</span> <span class="pre">--all</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">cugbasis</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="c1"># Load the wavefunction information</span>
<span class="n">fchk_path</span> <span class="o">=</span> <span class="s2">&quot;./FEFEFKEK_0_q-01_m01_k00_force_uwb97xd_def2svpd.fchk&quot;</span>
<span class="n">mol</span> <span class="o">=</span> <span class="n">cugbasis</span><span class="o">.</span><span class="n">Molecule</span><span class="p">(</span><span class="n">fchk_path</span><span class="p">)</span>

<span class="c1"># Get the atomic coordinates and numbers</span>
<span class="n">atom_coords</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">coordinates</span>
<span class="n">atom_numbers</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">numbers</span>
<span class="n">natoms</span> <span class="o">=</span> <span class="n">atom_coords</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">grid.onedgrid</span> <span class="kn">import</span> <span class="n">OneDGrid</span>
<span class="kn">from</span> <span class="nn">grid.atomgrid</span> <span class="kn">import</span> <span class="n">AtomGrid</span>

<span class="c1"># Construct a radial grid will upper bound (1.5) and step-size (0.25)</span>
<span class="c1">#   to propogate out of each atom</span>
<span class="n">u_bnd_rad</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">ss_rad</span> <span class="o">=</span> <span class="mf">0.25</span>
<span class="n">rad_grid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="n">u_bnd_rad</span><span class="p">,</span> <span class="n">ss_rad</span><span class="p">)</span>
<span class="n">rgrid</span> <span class="o">=</span> <span class="n">OneDGrid</span><span class="p">(</span><span class="n">points</span><span class="o">=</span><span class="n">rad_grid</span><span class="p">,</span> <span class="n">weights</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">empty</span><span class="p">(</span><span class="n">rad_grid</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

<span class="c1"># Construct a Becke-Lebedev grid around each atom using the</span>
<span class="c1">#    previous radial grid</span>
<span class="n">atom_grids_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">natoms</span><span class="p">):</span>
    <span class="n">atomic_grid</span> <span class="o">=</span> <span class="n">AtomGrid</span><span class="o">.</span><span class="n">from_preset</span><span class="p">(</span>
        <span class="mi">10</span><span class="p">,</span> <span class="n">preset</span><span class="o">=</span><span class="s2">&quot;fine&quot;</span><span class="p">,</span> <span class="n">rgrid</span><span class="o">=</span><span class="n">rgrid</span><span class="p">,</span> <span class="n">center</span><span class="o">=</span><span class="n">atom_coords</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="p">)</span>
    <span class="n">atom_grids_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">atomic_grid</span><span class="o">.</span><span class="n">points</span><span class="p">)</span>

<span class="c1"># Concatenate all of the points together to make the initial guess</span>
<span class="n">pts</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">vstack</span><span class="p">(</span><span class="n">atom_grids_list</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">chemtools.topology.critical</span> <span class="kn">import</span> <span class="n">Topology</span>

<span class="n">dens_func</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_density</span>
<span class="n">grad_func</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_gradient</span>
<span class="n">hess_func</span> <span class="o">=</span> <span class="n">mol</span><span class="o">.</span><span class="n">compute_hessian</span>

<span class="n">topo</span> <span class="o">=</span> <span class="n">Topology</span><span class="p">(</span><span class="n">dens_func</span><span class="p">,</span> <span class="n">grad_func</span><span class="p">,</span> <span class="n">hess_func</span><span class="p">,</span> <span class="n">coords</span><span class="o">=</span><span class="n">atom_coords</span><span class="p">)</span>
<span class="n">topo</span><span class="o">.</span><span class="n">find_critical_points_vectorized</span><span class="p">(</span><span class="n">atom_coords</span><span class="p">,</span> <span class="n">use_log</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Is Poincare-Hopf Equation Satisfied?:  </span><span class="si">{</span><span class="n">topo</span><span class="o">.</span><span class="n">poincare_hopf_equation</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">topo</span><span class="o">.</span><span class="n">find_bond_paths</span><span class="p">(</span><span class="n">tol</span><span class="o">=</span><span class="mf">1e-8</span><span class="p">,</span> <span class="n">max_ss</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Start Critical Points Finding.
Number of initial points: 74279
Iteration: 1,   Sum Gradient Norm of pts left: 68668.55898004257   Number of pts left: 74279
Iteration: 2,   Sum Gradient Norm of pts left: 121405.86514622386   Number of pts left: 68134
Iteration: 3,   Sum Gradient Norm of pts left: 81586.41131677461   Number of pts left: 61022
Iteration: 4,   Sum Gradient Norm of pts left: 63757.78149726375   Number of pts left: 55896
Iteration: 5,   Sum Gradient Norm of pts left: 59045.08260932944   Number of pts left: 51028
Iteration: 6,   Sum Gradient Norm of pts left: 38512.94224547554   Number of pts left: 42393
Iteration: 7,   Sum Gradient Norm of pts left: 30166.96434139207   Number of pts left: 32930
Iteration: 8,   Sum Gradient Norm of pts left: 25855.143586075214   Number of pts left: 25257
Iteration: 9,   Sum Gradient Norm of pts left: 19961.031097529805   Number of pts left: 19229
Iteration: 10,   Sum Gradient Norm of pts left: 11775.062802642467   Number of pts left: 14686
Iteration: 11,   Sum Gradient Norm of pts left: 11812.466333526627   Number of pts left: 11468
Iteration: 12,   Sum Gradient Norm of pts left: 8055.682524020028   Number of pts left: 9206
Iteration: 13,   Sum Gradient Norm of pts left: 7104.043773485118   Number of pts left: 7380
Iteration: 14,   Sum Gradient Norm of pts left: 7536.167238764821   Number of pts left: 6029
Iteration: 15,   Sum Gradient Norm of pts left: 5192.358819538544   Number of pts left: 4947
Iteration: 16,   Sum Gradient Norm of pts left: 5242.4103031197255   Number of pts left: 4129
Iteration: 17,   Sum Gradient Norm of pts left: 3539.9513222697797   Number of pts left: 3451
Iteration: 18,   Sum Gradient Norm of pts left: 2534.2741055412166   Number of pts left: 2946
Iteration: 19,   Sum Gradient Norm of pts left: 1728.4041613435886   Number of pts left: 2534
Iteration: 20,   Sum Gradient Norm of pts left: 3031.9845032207822   Number of pts left: 2212
Iteration: 21,   Sum Gradient Norm of pts left: 1295.0878153503463   Number of pts left: 1941
Iteration: 22,   Sum Gradient Norm of pts left: 1249.4600724206746   Number of pts left: 1728
Iteration: 23,   Sum Gradient Norm of pts left: 263.3962998487871   Number of pts left: 1554
Iteration: 24,   Sum Gradient Norm of pts left: 579.6970923448117   Number of pts left: 1410
Iteration: 25,   Sum Gradient Norm of pts left: 406.58215129739654   Number of pts left: 1266
Iteration: 26,   Sum Gradient Norm of pts left: 1641.8926885105432   Number of pts left: 1160
Iteration: 27,   Sum Gradient Norm of pts left: 972.7155557733744   Number of pts left: 1065
Iteration: 28,   Sum Gradient Norm of pts left: 1132.9942955742306   Number of pts left: 999
Iteration: 29,   Sum Gradient Norm of pts left: 593.7110350824705   Number of pts left: 933
Iteration: 30,   Sum Gradient Norm of pts left: 108.17826787273279   Number of pts left: 853
Iteration: 31,   Sum Gradient Norm of pts left: 43.92215841839177   Number of pts left: 790
Iteration: 32,   Sum Gradient Norm of pts left: 395.0950807268141   Number of pts left: 739
Iteration: 33,   Sum Gradient Norm of pts left: 42.56095194417098   Number of pts left: 692
Iteration: 34,   Sum Gradient Norm of pts left: 62.772237815168516   Number of pts left: 647
Iteration: 35,   Sum Gradient Norm of pts left: 151.1617726740986   Number of pts left: 603
Iteration: 36,   Sum Gradient Norm of pts left: 855.4277669432372   Number of pts left: 579
Iteration: 37,   Sum Gradient Norm of pts left: 30.94301839917721   Number of pts left: 548
Iteration: 38,   Sum Gradient Norm of pts left: 94.32372624549518   Number of pts left: 516
Iteration: 39,   Sum Gradient Norm of pts left: 37.96333137521147   Number of pts left: 491
Iteration: 40,   Sum Gradient Norm of pts left: 42.45551461651678   Number of pts left: 472
Iteration: 41,   Sum Gradient Norm of pts left: 19.138671654681673   Number of pts left: 452
Iteration: 42,   Sum Gradient Norm of pts left: 54.679243201784985   Number of pts left: 429
Iteration: 43,   Sum Gradient Norm of pts left: 48.277000277030005   Number of pts left: 417
Iteration: 44,   Sum Gradient Norm of pts left: 63.14895858899038   Number of pts left: 405
Iteration: 45,   Sum Gradient Norm of pts left: 344.55328787073523   Number of pts left: 383
Iteration: 46,   Sum Gradient Norm of pts left: 11.737965759300888   Number of pts left: 361
Iteration: 47,   Sum Gradient Norm of pts left: 35.67980828149621   Number of pts left: 339
Iteration: 48,   Sum Gradient Norm of pts left: 8.20183763269641   Number of pts left: 330
Iteration: 49,   Sum Gradient Norm of pts left: 14.665850772267339   Number of pts left: 320
Iteration: 50,   Sum Gradient Norm of pts left: 78.81895950442784   Number of pts left: 297
Iteration: 51,   Sum Gradient Norm of pts left: 8.603011433113913   Number of pts left: 285
Iteration: 52,   Sum Gradient Norm of pts left: 6.013031747018265   Number of pts left: 271
Iteration: 53,   Sum Gradient Norm of pts left: 4.107767877372855   Number of pts left: 262
Iteration: 54,   Sum Gradient Norm of pts left: 10.393534081335408   Number of pts left: 254
Iteration: 55,   Sum Gradient Norm of pts left: 11.808410400457326   Number of pts left: 246
Iteration: 56,   Sum Gradient Norm of pts left: 5.210784123929768   Number of pts left: 231
Iteration: 57,   Sum Gradient Norm of pts left: 2.961970587927477   Number of pts left: 222
Iteration: 58,   Sum Gradient Norm of pts left: 3.8837906404734275   Number of pts left: 221
Iteration: 59,   Sum Gradient Norm of pts left: 3.5747880530162286   Number of pts left: 214
Iteration: 60,   Sum Gradient Norm of pts left: 11.10196786100471   Number of pts left: 206
Iteration: 61,   Sum Gradient Norm of pts left: 2.7723398672684834   Number of pts left: 192
Iteration: 62,   Sum Gradient Norm of pts left: 110.27960611983572   Number of pts left: 185
Iteration: 63,   Sum Gradient Norm of pts left: 4.022918016679588   Number of pts left: 180
Iteration: 64,   Sum Gradient Norm of pts left: 3.2273689227843416   Number of pts left: 179
Iteration: 65,   Sum Gradient Norm of pts left: 17.584723084394287   Number of pts left: 174
Iteration: 66,   Sum Gradient Norm of pts left: 2.440265506546463   Number of pts left: 169
Iteration: 67,   Sum Gradient Norm of pts left: 79.8814100444962   Number of pts left: 163
Iteration: 68,   Sum Gradient Norm of pts left: 2.641816787589227   Number of pts left: 155
Iteration: 69,   Sum Gradient Norm of pts left: 1.871861306400455   Number of pts left: 154
Iteration: 70,   Sum Gradient Norm of pts left: 0.7799662927130979   Number of pts left: 150
Iteration: 71,   Sum Gradient Norm of pts left: 1.1737723843371897   Number of pts left: 144
Iteration: 72,   Sum Gradient Norm of pts left: 2.924783787403729   Number of pts left: 142
Iteration: 73,   Sum Gradient Norm of pts left: 2.0291965179805094   Number of pts left: 137
Iteration: 74,   Sum Gradient Norm of pts left: 738.3604937281779   Number of pts left: 134
Iteration: 75,   Sum Gradient Norm of pts left: 0.9516235062150695   Number of pts left: 133
Iteration: 76,   Sum Gradient Norm of pts left: 0.8877678750879456   Number of pts left: 129
Iteration: 77,   Sum Gradient Norm of pts left: 106.70701597852167   Number of pts left: 129
Iteration: 78,   Sum Gradient Norm of pts left: 1.1287439521854805   Number of pts left: 124
Iteration: 79,   Sum Gradient Norm of pts left: 1.4297682113041854   Number of pts left: 121
Iteration: 80,   Sum Gradient Norm of pts left: 1.0798656431493001   Number of pts left: 119
Iteration: 81,   Sum Gradient Norm of pts left: 1.1491553526788758   Number of pts left: 117
Iteration: 82,   Sum Gradient Norm of pts left: 1.4505577126712454   Number of pts left: 115
Iteration: 83,   Sum Gradient Norm of pts left: 0.9247986453807715   Number of pts left: 115
Iteration: 84,   Sum Gradient Norm of pts left: 1.2371529693094776   Number of pts left: 110
Iteration: 85,   Sum Gradient Norm of pts left: 7.708037312884642   Number of pts left: 110
Iteration: 86,   Sum Gradient Norm of pts left: 1.7355027243199928   Number of pts left: 108
Iteration: 87,   Sum Gradient Norm of pts left: 1.0549085104745477   Number of pts left: 104
Iteration: 88,   Sum Gradient Norm of pts left: 1.059773131461493   Number of pts left: 102
Iteration: 89,   Sum Gradient Norm of pts left: 5.0133307800751545   Number of pts left: 100
Iteration: 90,   Sum Gradient Norm of pts left: 2.3623847316389286   Number of pts left: 98
Iteration: 91,   Sum Gradient Norm of pts left: 1.4117106527801102   Number of pts left: 98
Iteration: 92,   Sum Gradient Norm of pts left: 0.689202482801012   Number of pts left: 95
Iteration: 93,   Sum Gradient Norm of pts left: 1.2037735129452813   Number of pts left: 94
Iteration: 94,   Sum Gradient Norm of pts left: 0.8728584746545788   Number of pts left: 93
Iteration: 95,   Sum Gradient Norm of pts left: 1.1450511057127608   Number of pts left: 90
Iteration: 96,   Sum Gradient Norm of pts left: 3.078963229492075   Number of pts left: 90
Iteration: 97,   Sum Gradient Norm of pts left: 1.0394119332353533   Number of pts left: 89
Iteration: 98,   Sum Gradient Norm of pts left: 0.8131383507560603   Number of pts left: 87
Iteration: 99,   Sum Gradient Norm of pts left: 2.8740313487972116   Number of pts left: 85
Iteration: 100,   Sum Gradient Norm of pts left: 1.1039169497707235   Number of pts left: 85
Iteration: 101,   Sum Gradient Norm of pts left: 1.8394614099709568   Number of pts left: 84
Iteration: 102,   Sum Gradient Norm of pts left: 1.0597689351461799   Number of pts left: 81
Iteration: 103,   Sum Gradient Norm of pts left: 2.5827442499436475   Number of pts left: 81
Iteration: 104,   Sum Gradient Norm of pts left: 0.7786093912449257   Number of pts left: 79
Iteration: 105,   Sum Gradient Norm of pts left: 0.686749349339473   Number of pts left: 77
Iteration: 106,   Sum Gradient Norm of pts left: 0.8843939419015349   Number of pts left: 76
Iteration: 107,   Sum Gradient Norm of pts left: 2.5881635879951066   Number of pts left: 74
Iteration: 108,   Sum Gradient Norm of pts left: 12.006936400316551   Number of pts left: 71
Iteration: 109,   Sum Gradient Norm of pts left: 54.602203659449785   Number of pts left: 70
Iteration: 110,   Sum Gradient Norm of pts left: 1.4805984507903105   Number of pts left: 70
Iteration: 111,   Sum Gradient Norm of pts left: 1.800793777939802   Number of pts left: 69
Iteration: 112,   Sum Gradient Norm of pts left: 1.0911839251477975   Number of pts left: 68
Iteration: 113,   Sum Gradient Norm of pts left: 0.7735461938493347   Number of pts left: 66
Iteration: 114,   Sum Gradient Norm of pts left: 0.5639348002439291   Number of pts left: 64
Iteration: 115,   Sum Gradient Norm of pts left: 0.5070131822579609   Number of pts left: 64
Iteration: 116,   Sum Gradient Norm of pts left: 0.593530626445337   Number of pts left: 64
Iteration: 117,   Sum Gradient Norm of pts left: 0.4718776185508299   Number of pts left: 63
Iteration: 118,   Sum Gradient Norm of pts left: 0.8236434650936505   Number of pts left: 62
Iteration: 119,   Sum Gradient Norm of pts left: 0.3408423531033296   Number of pts left: 62
Iteration: 120,   Sum Gradient Norm of pts left: 0.3825715607398019   Number of pts left: 61
Iteration: 121,   Sum Gradient Norm of pts left: 0.2181355748390945   Number of pts left: 60
Iteration: 122,   Sum Gradient Norm of pts left: 0.2335674727919163   Number of pts left: 60
Iteration: 123,   Sum Gradient Norm of pts left: 0.4108371022360938   Number of pts left: 60
Iteration: 124,   Sum Gradient Norm of pts left: 0.4039296039471612   Number of pts left: 60
Iteration: 125,   Sum Gradient Norm of pts left: 0.2588884724492406   Number of pts left: 60
Iteration: 126,   Sum Gradient Norm of pts left: 0.4560571251264232   Number of pts left: 60
Iteration: 127,   Sum Gradient Norm of pts left: 0.3190243437523975   Number of pts left: 60
Iteration: 128,   Sum Gradient Norm of pts left: 0.3186459673960767   Number of pts left: 60
Iteration: 129,   Sum Gradient Norm of pts left: 0.39256409435544876   Number of pts left: 60
Iteration: 130,   Sum Gradient Norm of pts left: 0.23923278748332427   Number of pts left: 59
Iteration: 131,   Sum Gradient Norm of pts left: 0.5471033373217847   Number of pts left: 59
Iteration: 132,   Sum Gradient Norm of pts left: 0.6211803833374914   Number of pts left: 59
Iteration: 133,   Sum Gradient Norm of pts left: 0.2761666828106832   Number of pts left: 58
Iteration: 134,   Sum Gradient Norm of pts left: 0.40958691747945514   Number of pts left: 58
Iteration: 135,   Sum Gradient Norm of pts left: 0.20479536583330268   Number of pts left: 58
Iteration: 136,   Sum Gradient Norm of pts left: 0.2289204436682763   Number of pts left: 56
Iteration: 137,   Sum Gradient Norm of pts left: 0.4020135311589622   Number of pts left: 55
Iteration: 138,   Sum Gradient Norm of pts left: 0.21190681338224426   Number of pts left: 55
Iteration: 139,   Sum Gradient Norm of pts left: 0.5276026847613123   Number of pts left: 55
Iteration: 140,   Sum Gradient Norm of pts left: 4.387734752008945   Number of pts left: 55
Iteration: 141,   Sum Gradient Norm of pts left: 1.5211947243084862   Number of pts left: 54
Iteration: 142,   Sum Gradient Norm of pts left: 0.9395755879290218   Number of pts left: 54
Iteration: 143,   Sum Gradient Norm of pts left: 27.669908976819354   Number of pts left: 54
Iteration: 144,   Sum Gradient Norm of pts left: 1.0939992213095586   Number of pts left: 53
Iteration: 145,   Sum Gradient Norm of pts left: 0.19762267036384804   Number of pts left: 53
Iteration: 146,   Sum Gradient Norm of pts left: 0.2844144915900022   Number of pts left: 53
Iteration: 147,   Sum Gradient Norm of pts left: 0.22319556495769755   Number of pts left: 53
Iteration: 148,   Sum Gradient Norm of pts left: 0.28336944614065385   Number of pts left: 53
Iteration: 149,   Sum Gradient Norm of pts left: 0.41817873885293544   Number of pts left: 53
Iteration: 150,   Sum Gradient Norm of pts left: 20.105152069655823   Number of pts left: 53
Iteration: 151,   Sum Gradient Norm of pts left: 0.4034221534097332   Number of pts left: 53
Iteration: 152,   Sum Gradient Norm of pts left: 0.3690319985361999   Number of pts left: 53
Iteration: 153,   Sum Gradient Norm of pts left: 0.417097642852235   Number of pts left: 53
Iteration: 154,   Sum Gradient Norm of pts left: 0.18526444100489078   Number of pts left: 53
Iteration: 155,   Sum Gradient Norm of pts left: 0.19036551229855   Number of pts left: 52
Iteration: 156,   Sum Gradient Norm of pts left: 0.35958007529478525   Number of pts left: 51
Iteration: 157,   Sum Gradient Norm of pts left: 2.7081752678644664   Number of pts left: 50
Iteration: 158,   Sum Gradient Norm of pts left: 1.1498544859018576   Number of pts left: 50
Iteration: 159,   Sum Gradient Norm of pts left: 0.7738765089817964   Number of pts left: 50
Iteration: 160,   Sum Gradient Norm of pts left: 0.44915214723565444   Number of pts left: 50
Iteration: 161,   Sum Gradient Norm of pts left: 0.5887278196677075   Number of pts left: 49
Iteration: 162,   Sum Gradient Norm of pts left: 0.8190985030960872   Number of pts left: 49
Iteration: 163,   Sum Gradient Norm of pts left: 0.549169160937144   Number of pts left: 48
Iteration: 164,   Sum Gradient Norm of pts left: 0.209317848940976   Number of pts left: 47
Iteration: 165,   Sum Gradient Norm of pts left: 0.25642238948989066   Number of pts left: 46
Iteration: 166,   Sum Gradient Norm of pts left: 0.1724981507183297   Number of pts left: 45
Iteration: 167,   Sum Gradient Norm of pts left: 0.18235784775279393   Number of pts left: 45
Iteration: 168,   Sum Gradient Norm of pts left: 0.21043409544039707   Number of pts left: 45
Iteration: 169,   Sum Gradient Norm of pts left: 0.1802094156070251   Number of pts left: 45
Iteration: 170,   Sum Gradient Norm of pts left: 0.42329956650575534   Number of pts left: 45
Iteration: 171,   Sum Gradient Norm of pts left: 0.39547717679719663   Number of pts left: 45
Iteration: 172,   Sum Gradient Norm of pts left: 0.23688093929588275   Number of pts left: 45
Iteration: 173,   Sum Gradient Norm of pts left: 0.1817067141094791   Number of pts left: 45
Iteration: 174,   Sum Gradient Norm of pts left: 0.1932889677569583   Number of pts left: 45
Iteration: 175,   Sum Gradient Norm of pts left: 0.15905108826992068   Number of pts left: 45
Iteration: 176,   Sum Gradient Norm of pts left: 0.19223729048918872   Number of pts left: 44
Iteration: 177,   Sum Gradient Norm of pts left: 0.18357986085259542   Number of pts left: 44
Iteration: 178,   Sum Gradient Norm of pts left: 0.1708321242752671   Number of pts left: 44
Iteration: 179,   Sum Gradient Norm of pts left: 0.17863384613041716   Number of pts left: 44
Iteration: 180,   Sum Gradient Norm of pts left: 0.19925285099797752   Number of pts left: 44
Iteration: 181,   Sum Gradient Norm of pts left: 0.16071651708706255   Number of pts left: 44
Iteration: 182,   Sum Gradient Norm of pts left: 0.18805403135813384   Number of pts left: 44
Iteration: 183,   Sum Gradient Norm of pts left: 0.18269785178750192   Number of pts left: 44
Iteration: 184,   Sum Gradient Norm of pts left: 0.17389708564330475   Number of pts left: 44
Iteration: 185,   Sum Gradient Norm of pts left: 0.1773423222495032   Number of pts left: 44
Iteration: 186,   Sum Gradient Norm of pts left: 0.1952494966603132   Number of pts left: 44
Iteration: 187,   Sum Gradient Norm of pts left: 0.15949511112197398   Number of pts left: 44
Iteration: 188,   Sum Gradient Norm of pts left: 0.1914774957349511   Number of pts left: 44
Iteration: 189,   Sum Gradient Norm of pts left: 0.18498392133743255   Number of pts left: 44
Iteration: 190,   Sum Gradient Norm of pts left: 0.1712567418980242   Number of pts left: 44
Iteration: 191,   Sum Gradient Norm of pts left: 0.17693691211049653   Number of pts left: 44
Iteration: 192,   Sum Gradient Norm of pts left: 0.19700698807107506   Number of pts left: 44
Iteration: 193,   Sum Gradient Norm of pts left: 0.1600092194002104   Number of pts left: 44
Iteration: 194,   Sum Gradient Norm of pts left: 0.18807172495156183   Number of pts left: 44
Iteration: 195,   Sum Gradient Norm of pts left: 0.18290593503927632   Number of pts left: 44
Iteration: 196,   Sum Gradient Norm of pts left: 0.17404778589055414   Number of pts left: 44
Iteration: 197,   Sum Gradient Norm of pts left: 0.17836316793185333   Number of pts left: 44
Iteration: 198,   Sum Gradient Norm of pts left: 0.19540735460618683   Number of pts left: 44
Iteration: 199,   Sum Gradient Norm of pts left: 0.15999896167568867   Number of pts left: 44
Iteration: 200,   Sum Gradient Norm of pts left: 0.19158890320205035   Number of pts left: 44
Iteration: 201,   Sum Gradient Norm of pts left: 0.18268639331718578   Number of pts left: 44
Iteration: 202,   Sum Gradient Norm of pts left: 0.1710130355189225   Number of pts left: 44
Iteration: 203,   Sum Gradient Norm of pts left: 0.1767808708857762   Number of pts left: 44
Iteration: 204,   Sum Gradient Norm of pts left: 0.1976074526075174   Number of pts left: 44
Iteration: 205,   Sum Gradient Norm of pts left: 0.15989815037700644   Number of pts left: 44
Iteration: 206,   Sum Gradient Norm of pts left: 0.18881263246887275   Number of pts left: 44
Iteration: 207,   Sum Gradient Norm of pts left: 0.1842364529817766   Number of pts left: 44
Iteration: 208,   Sum Gradient Norm of pts left: 0.17446894824817452   Number of pts left: 44
Iteration: 209,   Sum Gradient Norm of pts left: 0.17758796804892782   Number of pts left: 44
Iteration: 210,   Sum Gradient Norm of pts left: 0.193300849193229   Number of pts left: 44
Iteration: 211,   Sum Gradient Norm of pts left: 0.22166539117551287   Number of pts left: 44
Iteration: 212,   Sum Gradient Norm of pts left: 0.20430974312398853   Number of pts left: 44
Iteration: 213,   Sum Gradient Norm of pts left: 0.19919553831460166   Number of pts left: 44
Iteration: 214,   Sum Gradient Norm of pts left: 0.17066142709222465   Number of pts left: 44
Iteration: 215,   Sum Gradient Norm of pts left: 0.1793907654975197   Number of pts left: 44
Iteration: 216,   Sum Gradient Norm of pts left: 0.22480373150083577   Number of pts left: 44
Iteration: 217,   Sum Gradient Norm of pts left: 0.1626487246513282   Number of pts left: 44
Iteration: 218,   Sum Gradient Norm of pts left: 0.19043415813752398   Number of pts left: 44
Iteration: 219,   Sum Gradient Norm of pts left: 0.18271065526156574   Number of pts left: 44
Iteration: 220,   Sum Gradient Norm of pts left: 0.1812973808039301   Number of pts left: 44
Iteration: 221,   Sum Gradient Norm of pts left: 0.27655415954007856   Number of pts left: 44
Iteration: 222,   Sum Gradient Norm of pts left: 0.21391668508241482   Number of pts left: 44
Iteration: 223,   Sum Gradient Norm of pts left: 0.22969055346531744   Number of pts left: 44
Iteration: 224,   Sum Gradient Norm of pts left: 0.19383097993274173   Number of pts left: 44
Iteration: 225,   Sum Gradient Norm of pts left: 0.2683900771528395   Number of pts left: 44
Iteration: 226,   Sum Gradient Norm of pts left: 0.18436285531462182   Number of pts left: 44
Iteration: 227,   Sum Gradient Norm of pts left: 0.17695213148551028   Number of pts left: 44
Iteration: 228,   Sum Gradient Norm of pts left: 0.1966136838516205   Number of pts left: 43
Iteration: 229,   Sum Gradient Norm of pts left: 0.1597277486948572   Number of pts left: 43
Iteration: 230,   Sum Gradient Norm of pts left: 0.18780809084530428   Number of pts left: 43
Iteration: 231,   Sum Gradient Norm of pts left: 0.18279901400741425   Number of pts left: 43
Iteration: 232,   Sum Gradient Norm of pts left: 0.17421077968489962   Number of pts left: 43
Iteration: 233,   Sum Gradient Norm of pts left: 0.1773597075646241   Number of pts left: 43
Iteration: 234,   Sum Gradient Norm of pts left: 0.19528926147681577   Number of pts left: 43
Iteration: 235,   Sum Gradient Norm of pts left: 0.15966956462754955   Number of pts left: 43
Iteration: 236,   Sum Gradient Norm of pts left: 0.1914293723829972   Number of pts left: 43
Iteration: 237,   Sum Gradient Norm of pts left: 0.182425521679014   Number of pts left: 43
Iteration: 238,   Sum Gradient Norm of pts left: 0.17018912816647064   Number of pts left: 43
Iteration: 239,   Sum Gradient Norm of pts left: 0.1766262845329997   Number of pts left: 43
Iteration: 240,   Sum Gradient Norm of pts left: 0.1973042801156968   Number of pts left: 43
Iteration: 241,   Sum Gradient Norm of pts left: 0.16014294100851353   Number of pts left: 43
Iteration: 242,   Sum Gradient Norm of pts left: 0.18801039280031243   Number of pts left: 43
Iteration: 243,   Sum Gradient Norm of pts left: 0.18394666871515775   Number of pts left: 43
Iteration: 244,   Sum Gradient Norm of pts left: 0.17455118721046706   Number of pts left: 43
Iteration: 245,   Sum Gradient Norm of pts left: 0.17730314807998535   Number of pts left: 43
Iteration: 246,   Sum Gradient Norm of pts left: 0.19305709821427366   Number of pts left: 43
Iteration: 247,   Sum Gradient Norm of pts left: 0.15902294776685857   Number of pts left: 43
Iteration: 248,   Sum Gradient Norm of pts left: 0.19124790841627695   Number of pts left: 43
Iteration: 249,   Sum Gradient Norm of pts left: 0.18337947470160273   Number of pts left: 43
Iteration: 250,   Sum Gradient Norm of pts left: 0.17074305204912885   Number of pts left: 43
Convergence not achieved, attempt using Scipy. Number of points didn&#39;t converge: 12
Final number of points found 450
Is Poincare-Hopf Equation Satisfied?:  True
</pre></div></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython2 notranslate"><div class="highlight"><pre><span></span><span class="o">%</span><span class="k">matplotlib</span> inline
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># Grab the critical points</span>
<span class="n">bcp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">coordinate</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">bcp</span><span class="p">])</span>
<span class="n">nna</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">coordinate</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">nna</span><span class="p">])</span>
<span class="n">rcp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">coordinate</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">rcp</span><span class="p">])</span>
<span class="n">ccp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="o">.</span><span class="n">coordinate</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="n">topo</span><span class="o">.</span><span class="n">ccp</span><span class="p">])</span>

<span class="c1"># Plot the critical points and bond paths</span>
<span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="n">subplot_kw</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;projection&#39;</span><span class="p">:</span> <span class="s1">&#39;3d&#39;</span><span class="p">})</span>
<span class="c1"># Plot the bond paths</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="n">topo</span><span class="o">.</span><span class="n">bcp</span><span class="p">)):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span><span class="p">):</span>
        <span class="n">p</span> <span class="o">=</span> <span class="n">topo</span><span class="o">.</span><span class="n">bp</span><span class="p">[</span><span class="n">i</span><span class="p">][</span><span class="n">j</span><span class="p">]</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">p</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">p</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">p</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1"># Plot the critical points</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">rcp</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">rcp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">rcp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">rcp</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;y&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;RCP&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">ccp</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">ccp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">ccp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">ccp</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;m&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;CCP&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">bcp</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">bcp</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">bcp</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;b&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;BCP&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">nna</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">nna</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">nna</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">c</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;(N)NA&quot;</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="mi">50</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;lower center&quot;</span><span class="p">,</span> <span class="n">shadow</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;expand&quot;</span><span class="p">)</span> <span class="c1">#</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;QTAIM Critical Points and Bond Paths&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="mi">25</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="_images/critical_points_11_0.png" src="_images/critical_points_11_0.png" />
</div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quick_start.html" class="btn btn-neutral float-left" title="Quick Start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="reduced_density_gradient.html" class="btn btn-neutral float-right" title="Non-Covalent Interaction Index" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, QC-Devs.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>